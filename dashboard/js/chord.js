
// From http://mkweb.bcgsc.ca/circos/guide/tables/
var matrix = [];

// function listToMatrix(list, elementsPerSubArray) {
//   var matrix = [], i, k;
//   for (i = 0, k = -1; i < list.length; i++) {
//     if (i % elementsPerSubArray === 0) {
//       k++;
//       matrix[k] = [];
//     }
//     matrix[k].push(list[i]);
//   }
//   return matrix;
// }

json = JSON.parse('[{"01":558,"02":515,"03":508,"04":468,"05":483,"06":509,"07":492,"08":512,"09":490,"10":489,"11":529,"12":480,"13":543,"14":501,"15":490,"16":487,"17":467,"18":473,"19":519,"20":498,"21":506,"22":509,"23":483,"24":448,"25":483,"26":520,"27":503,"28":511,"29":528,"30":598,"31":471,"32":506},{"01":493,"02":501,"03":501,"04":518,"05":524,"06":505,"07":521,"08":521,"09":478,"10":504,"11":565,"12":535,"13":485,"14":503,"15":514,"16":505,"17":586,"18":494,"19":487,"20":465,"21":485,"22":487,"23":461,"24":481,"25":476,"26":501,"27":495,"28":494,"29":518,"30":501,"31":519,"32":490},{"01":518,"02":507,"03":487,"04":499,"05":487,"06":475,"07":496,"08":510,"09":490,"10":500,"11":484,"12":500,"13":535,"14":505,"15":491,"16":521,"17":485,"18":522,"19":520,"20":482,"21":469,"22":531,"23":506,"24":525,"25":521,"26":504,"27":524,"28":508,"29":488,"30":476,"31":497,"32":519},{"01":504,"02":477,"03":495,"04":508,"05":502,"06":501,"07":489,"08":499,"09":466,"10":501,"11":488,"12":456,"13":549,"14":481,"15":468,"16":456,"17":532,"18":530,"19":503,"20":483,"21":489,"22":511,"23":506,"24":476,"25":501,"26":482,"27":467,"28":473,"29":490,"30":489,"31":532,"32":530},{"01":498,"02":517,"03":488,"04":482,"05":497,"06":535,"07":495,"08":535,"09":477,"10":490,"11":486,"12":538,"13":523,"14":496,"15":481,"16":497,"17":496,"18":538,"19":494,"20":456,"21":508,"22":485,"23":509,"24":550,"25":516,"26":490,"27":508,"28":496,"29":483,"30":484,"31":497,"32":468},{"01":507,"02":498,"03":501,"04":487,"05":497,"06":511,"07":459,"08":477,"09":484,"10":475,"11":512,"12":486,"13":513,"14":497,"15":493,"16":488,"17":508,"18":463,"19":490,"20":474,"21":527,"22":489,"23":520,"24":556,"25":527,"26":499,"27":472,"28":457,"29":513,"30":479,"31":532,"32":479},{"01":474,"02":489,"03":501,"04":472,"05":474,"06":501,"07":516,"08":486,"09":512,"10":497,"11":477,"12":491,"13":496,"14":506,"15":510,"16":496,"17":519,"18":509,"19":534,"20":500,"21":464,"22":508,"23":547,"24":494,"25":554,"26":461,"27":492,"28":490,"29":470,"30":474,"31":478,"32":491},{"01":496,"02":522,"03":478,"04":501,"05":489,"06":501,"07":526,"08":510,"09":484,"10":530,"11":491,"12":490,"13":508,"14":492,"15":498,"16":489,"17":500,"18":473,"19":489,"20":511,"21":447,"22":507,"23":463,"24":454,"25":473,"26":483,"27":507,"28":484,"29":472,"30":520,"31":504,"32":502},{"01":521,"02":488,"03":503,"04":482,"05":491,"06":511,"07":462,"08":516,"09":450,"10":511,"11":493,"12":483,"13":495,"14":503,"15":490,"16":469,"17":517,"18":487,"19":502,"20":491,"21":489,"22":509,"23":531,"24":491,"25":465,"26":471,"27":482,"28":532,"29":517,"30":461,"31":518,"32":493},{"01":484,"02":502,"03":468,"04":490,"05":548,"06":528,"07":519,"08":483,"09":506,"10":517,"11":481,"12":491,"13":527,"14":498,"15":508,"16":511,"17":546,"18":504,"19":523,"20":475,"21":487,"22":522,"23":505,"24":526,"25":519,"26":494,"27":475,"28":510,"29":439,"30":531,"31":519,"32":480},{"01":555,"02":541,"03":493,"04":521,"05":499,"06":523,"07":504,"08":499,"09":509,"10":482,"11":485,"12":466,"13":490,"14":513,"15":490,"16":488,"17":494,"18":484,"19":509,"20":466,"21":501,"22":482,"23":515,"24":506,"25":496,"26":519,"27":515,"28":506,"29":521,"30":488,"31":471,"32":538},{"01":485,"02":481,"03":519,"04":503,"05":510,"06":501,"07":483,"08":513,"09":464,"10":479,"11":500,"12":509,"13":498,"14":511,"15":455,"16":512,"17":493,"18":475,"19":488,"20":457,"21":510,"22":478,"23":491,"24":496,"25":491,"26":492,"27":517,"28":468,"29":503,"30":462,"31":523,"32":504},{"01":505,"02":517,"03":500,"04":509,"05":501,"06":516,"07":503,"08":495,"09":467,"10":500,"11":522,"12":538,"13":501,"14":480,"15":507,"16":486,"17":466,"18":509,"19":493,"20":474,"21":495,"22":494,"23":472,"24":492,"25":498,"26":533,"27":486,"28":506,"29":530,"30":499,"31":489,"32":505},{"01":507,"02":500,"03":522,"04":514,"05":490,"06":482,"07":500,"08":508,"09":504,"10":512,"11":484,"12":507,"13":507,"14":514,"15":504,"16":504,"17":462,"18":473,"19":482,"20":469,"21":482,"22":483,"23":478,"24":487,"25":531,"26":495,"27":532,"28":478,"29":467,"30":483,"31":523,"32":496},{"01":478,"02":533,"03":497,"04":500,"05":517,"06":486,"07":490,"08":537,"09":487,"10":539,"11":481,"12":497,"13":508,"14":513,"15":514,"16":494,"17":533,"18":450,"19":501,"20":539,"21":490,"22":474,"23":495,"24":492,"25":481,"26":506,"27":495,"28":528,"29":502,"30":508,"31":525,"32":489},{"01":505,"02":507,"03":496,"04":489,"05":493,"06":520,"07":499,"08":475,"09":479,"10":519,"11":505,"12":489,"13":494,"14":483,"15":495,"16":480,"17":507,"18":508,"19":509,"20":505,"21":491,"22":478,"23":506,"24":505,"25":512,"26":498,"27":484,"28":441,"29":473,"30":478,"31":481,"32":509},{"01":501,"02":500,"03":491,"04":532,"05":533,"06":482,"07":473,"08":504,"09":471,"10":520,"11":505,"12":485,"13":513,"14":516,"15":493,"16":513,"17":522,"18":521,"19":497,"20":519,"21":548,"22":553,"23":490,"24":523,"25":512,"26":488,"27":506,"28":548,"29":494,"30":560,"31":513,"32":489},{"01":454,"02":500,"03":496,"04":530,"05":481,"06":522,"07":521,"08":457,"09":496,"10":510,"11":491,"12":471,"13":497,"14":548,"15":497,"16":477,"17":481,"18":506,"19":518,"20":526,"21":500,"22":514,"23":470,"24":493,"25":453,"26":473,"27":515,"28":460,"29":533,"30":527,"31":493,"32":531},{"01":495,"02":492,"03":512,"04":521,"05":474,"06":475,"07":509,"08":449,"09":502,"10":506,"11":504,"12":533,"13":499,"14":536,"15":466,"16":475,"17":488,"18":528,"19":508,"20":493,"21":502,"22":513,"23":486,"24":528,"25":544,"26":499,"27":472,"28":503,"29":519,"30":506,"31":477,"32":503},{"01":496,"02":475,"03":515,"04":473,"05":503,"06":475,"07":525,"08":492,"09":556,"10":490,"11":519,"12":490,"13":491,"14":525,"15":454,"16":471,"17":481,"18":507,"19":508,"20":481,"21":491,"22":511,"23":529,"24":522,"25":470,"26":477,"27":500,"28":499,"29":517,"30":478,"31":528,"32":526},{"01":501,"02":487,"03":531,"04":512,"05":498,"06":524,"07":505,"08":477,"09":513,"10":474,"11":487,"12":471,"13":498,"14":484,"15":442,"16":494,"17":511,"18":567,"19":505,"20":478,"21":501,"22":501,"23":492,"24":508,"25":498,"26":539,"27":513,"28":496,"29":544,"30":519,"31":530,"32":472},{"01":478,"02":513,"03":480,"04":449,"05":515,"06":517,"07":524,"08":514,"09":499,"10":500,"11":503,"12":529,"13":471,"14":497,"15":474,"16":522,"17":490,"18":474,"19":538,"20":497,"21":495,"22":503,"23":491,"24":502,"25":491,"26":450,"27":501,"28":528,"29":493,"30":515,"31":495,"32":506},{"01":474,"02":527,"03":483,"04":490,"05":465,"06":526,"07":532,"08":508,"09":497,"10":504,"11":517,"12":525,"13":473,"14":502,"15":495,"16":510,"17":487,"18":486,"19":521,"20":485,"21":511,"22":460,"23":512,"24":545,"25":534,"26":501,"27":473,"28":486,"29":480,"30":508,"31":439,"32":480},{"01":474,"02":488,"03":515,"04":490,"05":535,"06":472,"07":463,"08":496,"09":500,"10":526,"11":524,"12":544,"13":520,"14":487,"15":517,"16":538,"17":478,"18":515,"19":460,"20":522,"21":484,"22":468,"23":498,"24":504,"25":479,"26":494,"27":537,"28":511,"29":484,"30":495,"31":492,"32":460},{"01":501,"02":504,"03":533,"04":491,"05":517,"06":482,"07":458,"08":479,"09":538,"10":461,"11":520,"12":523,"13":512,"14":540,"15":449,"16":488,"17":514,"18":443,"19":476,"20":538,"21":500,"22":500,"23":477,"24":478,"25":502,"26":503,"27":454,"28":497,"29":507,"30":486,"31":509,"32":507},{"01":487,"02":523,"03":499,"04":484,"05":565,"06":490,"07":502,"08":507,"09":515,"10":535,"11":474,"12":488,"13":521,"14":477,"15":522,"16":507,"17":525,"18":487,"19":529,"20":504,"21":448,"22":486,"23":478,"24":495,"25":520,"26":511,"27":518,"28":516,"29":475,"30":529,"31":467,"32":496},{"01":487,"02":501,"03":515,"04":459,"05":492,"06":496,"07":501,"08":484,"09":490,"10":498,"11":512,"12":493,"13":481,"14":554,"15":531,"16":528,"17":528,"18":489,"19":496,"20":539,"21":473,"22":478,"23":479,"24":501,"25":449,"26":476,"27":523,"28":508,"29":483,"30":528,"31":483,"32":505},{"01":495,"02":549,"03":480,"04":488,"05":493,"06":490,"07":480,"08":551,"09":476,"10":477,"11":507,"12":504,"13":515,"14":498,"15":476,"16":526,"17":497,"18":495,"19":521,"20":516,"21":485,"22":481,"23":505,"24":506,"25":482,"26":533,"27":498,"28":492,"29":535,"30":498,"31":491,"32":494},{"01":573,"02":510,"03":484,"04":507,"05":465,"06":512,"07":566,"08":488,"09":504,"10":516,"11":519,"12":494,"13":496,"14":498,"15":478,"16":522,"17":514,"18":497,"19":521,"20":535,"21":510,"22":529,"23":521,"24":512,"25":440,"26":475,"27":516,"28":444,"29":531,"30":508,"31":493,"32":496},{"01":524,"02":489,"03":494,"04":540,"05":463,"06":520,"07":486,"08":495,"09":535,"10":537,"11":510,"12":519,"13":511,"14":490,"15":511,"16":506,"17":499,"18":482,"19":517,"20":504,"21":505,"22":497,"23":543,"24":504,"25":519,"26":498,"27":507,"28":480,"29":483,"30":493,"31":465,"32":478},{"01":486,"02":503,"03":492,"04":485,"05":500,"06":505,"07":528,"08":540,"09":481,"10":512,"11":495,"12":514,"13":472,"14":525,"15":492,"16":529,"17":495,"18":485,"19":476,"20":486,"21":495,"22":506,"23":520,"24":505,"25":485,"26":469,"27":526,"28":496,"29":517,"30":505,"31":484,"32":514},{"01":511,"02":497,"03":550,"04":516,"05":509,"06":513,"07":487,"08":471,"09":513,"10":506,"11":494,"12":511,"13":473,"14":488,"15":529,"16":504,"17":483,"18":468,"19":473,"20":467,"21":497,"22":470,"23":534,"24":465,"25":463,"26":496,"27":527,"28":542,"29":529,"30":492,"31":516,"32":539}]');
// keys = []

// keys = json[0].map(function(state){
//   for (var i in state){
// })
json.forEach(function(state){
  row = [];
  for (var i in state){
    console.log(i)
    console.log(state[i])
    row.push(state[i]);
  }
  matrix.push(row);
});

console.log(matrix);
// console.log(matrix)
var chord = d3.layout.chord()
    .padding(.05)
    .sortSubgroups(d3.descending)
    .matrix(matrix);

var width = 960,
    height = 500,
    innerRadius = Math.min(width, height) * .41,
    outerRadius = innerRadius * 1.1;

var fill = d3.scale.category20();

var svg = d3.select("#chord-container").append("svg")
    .attr("viewBox", "0 0 "+ width + " "+ height)
    .attr("preserveAspectRatio", "xMinYMin meet")
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

svg.append("g").selectAll("path")
    .data(chord.groups)
  .enter().append("path")
    .style("fill", function(d) { return fill(d.index); })
    .style("stroke", function(d) { return fill(d.index); })
    .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
    .on("mouseover", fade(.1))
    .on("mouseout", fade(1));

var ticks = svg.append("g").selectAll("g")
    .data(chord.groups)
  .enter().append("g").selectAll("g")
    .data(groupTicks)
  .enter().append("g")
    .attr("transform", function(d) {
      return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
          + "translate(" + outerRadius + ",0)";
    });

ticks.append("line")
    .attr("x1", 1)
    .attr("y1", 0)
    .attr("x2", 5)
    .attr("y2", 0)
    .style("stroke", "#000");

ticks.append("text")
    .attr("x", 8)
    .attr("dy", ".35em")
    .attr("transform", function(d) { return d.angle > Math.PI ? "rotate(180)translate(-16)" : null; })
    .style("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
    .text(function(d) { return d.label; });

svg.append("g")
    .attr("class", "chord")
  .selectAll("path")
    .data(chord.chords)
  .enter().append("path")
    .attr("d", d3.svg.chord().radius(innerRadius))
    .style("fill", function(d) { return fill(d.target.index); })
    .style("opacity", 1);

// Returns an array of tick angles and labels, given a group.
function groupTicks(d) {
  var k = (d.endAngle - d.startAngle) / d.value;
  return d3.range(0, d.value, 1000).map(function(v, i) {
    return {
      angle: v * k + d.startAngle,
      label: i % 5 ? null : v / 1000 + "k"
    };
  });
}

// Returns an event handler for fading a given chord group.
function fade(opacity) {
  return function(g, i) {
    svg.selectAll(".chord path")
        .filter(function(d) { return d.source.index != i && d.target.index != i; })
      .transition()
        .style("opacity", opacity);
  };
}